<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>title</title>
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <!-- page content -->
    <div>
        Location:
        <input type="text" id="pos_lat", placeholder="Latitude"></input>
        <input type="text" id="pos_lon", placeholder="Longitude"></input>
    </div>
    <div>
        EZCOD:
        <input type="text" id="ezcod_5_10", placeholder="EZCOD 5:10">
        <input type="text" id="ezcod_5_11", placeholder="EZCOD 5:11">
        <input type="text" id="ezcod_5_12", placeholder="EZCOD 5:12">
    </div>

    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/ezpwd/ezcod_5.js"></script>		<!-- emscripten compiled ezcod_5 API -->
    <script src="js/ezpwd/ezcod_5_wrap.js"></script>
    <script type="text/javascript">
        $('input#ezcod_5_10')
            .data( 'encode', ezcod_5_10_encode )
            .data( 'decode', ezcod_5_10_decode );
        $('input#ezcod_5_11')
            .data( 'encode', ezcod_5_11_encode )
            .data( 'decode', ezcod_5_11_decode );
        $('input#ezcod_5_12')
            .data( 'encode', ezcod_5_12_encode )
            .data( 'decode', ezcod_5_12_decode );
        var 			updating= function( lat, lon )
        {
            $('input[id^="ezcod"')
                .each( function() {
                    $(this).val( $(this).data( 'encode' )( lat, lon ));
                });
            $('input#pos_lat').val( lat.toFixed( 7 ));
            $('input#pos_lon').val( lon.toFixed( 7 ));
       }

        var			encoding= function( e ) {
            // On blur/<return>, send new lat/lon values to encode
            if (e.type === 'keyup' && e.keyCode !== 10 && e.keyCode !== 13)
                return;
            var			lat	= $('input#pos_lat').val();
            var			lon	= $('input#pos_lon').val();
            if ( lat === undefined || lat == '' || lon === undefined || lon == '' )
                return;
            updating( lat, lon );
        }
        $('input[id^="pos"]')
            .off('blur keyup' )
            .on( 'blur keyup', encoding );

        var decoding	= function( e ) {
            // On blur/<return>, send new ezcod 5:N to decode and get new lat/lon
            if (e.type === 'keyup' && e.keyCode !== 10 && e.keyCode !== 13)
                return;
            var			cod	= $(this).val();
            if ( cod === undefined || cod == '' )
                return;
            var			pos	= $(this).data( 'decode' )( cod );
            updating( pos[0], pos[1] );
        }
        $('input[id^="ezcod"')
            .off( 'blur keyup' )
            .on(  'blur keyup', decoding );

    </script>
  </body>
</html>
